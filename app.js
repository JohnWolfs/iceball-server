"use strict";
var express = require('express');
var http = require('http');
var socketio = require('socket.io');
var UserManager_1 = require('./user/UserManager');
var RoomManager_1 = require('./room/RoomManager');
var ConnectionManager_1 = require('./ConnectionManager');
var app = express();
var server = http.createServer(app);
var io = socketio(server);
var userManager = UserManager_1.default.Instance;
var roomManager = RoomManager_1.default.Instance;
roomManager.io = io;
roomManager.startWatching();
io.on('connection', function (socket) {
    console.log('===> [user ' + socket.id + '] connected');
    var user = userManager.createUser(socket);
    new ConnectionManager_1.default().initSocketEvent(socket, user);
});
app.get('/', function (req, res) {
    res.send('welcome, but you go the wrong way.');
});
server.listen(process.env.PORT || (process.env.PORT = 3100), function () {
    console.log('System:  listening on ' + process.env.PORT);
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBS0EsSUFBTyxPQUFPLFdBQVcsU0FBUyxDQUFDLENBQUM7QUFDcEMsSUFBTyxJQUFJLFdBQVcsTUFBTSxDQUFDLENBQUM7QUFDOUIsSUFBTyxRQUFRLFdBQVcsV0FBVyxDQUFDLENBQUM7QUFHdkMsNEJBQXdCLG9CQUFvQixDQUFDLENBQUE7QUFDN0MsNEJBQXdCLG9CQUFvQixDQUFDLENBQUE7QUFDN0Msa0NBQThCLHFCQUFxQixDQUFDLENBQUE7QUFFcEQsSUFBSSxHQUFHLEdBQUcsT0FBTyxFQUFFLENBQUM7QUFDcEIsSUFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNwQyxJQUFJLEVBQUUsR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUM7QUFFMUIsSUFBSSxXQUFXLEdBQUcscUJBQVcsQ0FBQyxRQUFRLENBQUM7QUFDdkMsSUFBSSxXQUFXLEdBQUcscUJBQVcsQ0FBQyxRQUFRLENBQUM7QUFFdkMsV0FBVyxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUM7QUFHcEIsV0FBVyxDQUFDLGFBQWEsRUFBRSxDQUFDO0FBRzVCLEVBQUUsQ0FBQyxFQUFFLENBQUMsWUFBWSxFQUFFLFVBQVMsTUFBdUI7SUFDakQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxhQUFhLEdBQUcsTUFBTSxDQUFDLEVBQUUsR0FBRyxhQUFhLENBQUMsQ0FBQztJQUd0RCxJQUFJLElBQUksR0FBRyxXQUFXLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBRzFDLElBQUksMkJBQWlCLEVBQUUsQ0FBQyxlQUFlLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDO0FBRTFELENBQUMsQ0FBQyxDQUFDO0FBRUgsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsVUFBUyxHQUFHLEVBQUUsR0FBRztJQUM1QixHQUFHLENBQUMsSUFBSSxDQUFDLG9DQUFvQyxDQUFDLENBQUM7QUFDakQsQ0FBQyxDQUFDLENBQUM7QUFFSCxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLEVBQUU7SUFDM0QsT0FBTyxDQUFDLEdBQUcsQ0FBQyx3QkFBd0IsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQzNELENBQUMsQ0FBQyxDQUFDIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi90eXBpbmdzL25vZGUvbm9kZS5kLnRzXCIvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL3R5cGluZ3MvZXhwcmVzcy9leHByZXNzLmQudHNcIi8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vdHlwaW5ncy9zb2NrZXQuaW8vc29ja2V0LmlvLmQudHNcIi8+XG5cblxuaW1wb3J0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG5pbXBvcnQgaHR0cCA9IHJlcXVpcmUoJ2h0dHAnKTtcbmltcG9ydCBzb2NrZXRpbyA9IHJlcXVpcmUoJ3NvY2tldC5pbycpO1xuXG5pbXBvcnQgcm9vbSA9IHJlcXVpcmUoJy4vcm9vbS9Sb29tJyk7XG5pbXBvcnQgVXNlck1hbmFnZXIgZnJvbSAnLi91c2VyL1VzZXJNYW5hZ2VyJztcbmltcG9ydCBSb29tTWFuYWdlciBmcm9tICcuL3Jvb20vUm9vbU1hbmFnZXInO1xuaW1wb3J0IENvbm5lY3Rpb25NYW5hZ2VyIGZyb20gJy4vQ29ubmVjdGlvbk1hbmFnZXInO1xuXG5sZXQgYXBwID0gZXhwcmVzcygpO1xubGV0IHNlcnZlciA9IGh0dHAuY3JlYXRlU2VydmVyKGFwcCk7XG5sZXQgaW8gPSBzb2NrZXRpbyhzZXJ2ZXIpO1xuXG5sZXQgdXNlck1hbmFnZXIgPSBVc2VyTWFuYWdlci5JbnN0YW5jZTtcbmxldCByb29tTWFuYWdlciA9IFJvb21NYW5hZ2VyLkluc3RhbmNlO1xuXG5yb29tTWFuYWdlci5pbyA9IGlvO1xuXG4vLyDlvIDlp4vnm5HmtYvmiL/pl7Tor7fmsYLpmJ/liJdcbnJvb21NYW5hZ2VyLnN0YXJ0V2F0Y2hpbmcoKTtcblxuLy8g6YWN572uc29ja2V0LmlvXG5pby5vbignY29ubmVjdGlvbicsIGZ1bmN0aW9uKHNvY2tldDogU29ja2V0SU8uU29ja2V0KSB7XG5cdCAgY29uc29sZS5sb2coJz09PT4gW3VzZXIgJyArIHNvY2tldC5pZCArICddIGNvbm5lY3RlZCcpO1xuICAgIFxuICAgIC8vIOi/nuaOpeWQjOaXtuWIm+W7uueUqOaIt1xuICAgIGxldCB1c2VyID0gdXNlck1hbmFnZXIuY3JlYXRlVXNlcihzb2NrZXQpOyBcbiAgICBcbiAgICAvLyDliJ3lp4vljJZzb2NrZXTkuovku7ZcbiAgICBuZXcgQ29ubmVjdGlvbk1hbmFnZXIoKS5pbml0U29ja2V0RXZlbnQoc29ja2V0LCB1c2VyKTtcbiAgICBcbn0pO1xuXG5hcHAuZ2V0KCcvJywgZnVuY3Rpb24ocmVxLCByZXMpe1xuICByZXMuc2VuZCgnd2VsY29tZSwgYnV0IHlvdSBnbyB0aGUgd3Jvbmcgd2F5LicpO1xufSk7XG5cbnNlcnZlci5saXN0ZW4ocHJvY2Vzcy5lbnYuUE9SVCB8fCAocHJvY2Vzcy5lbnYuUE9SVCA9IDMxMDApLCBmdW5jdGlvbigpe1xuICBjb25zb2xlLmxvZygnU3lzdGVtOiAgbGlzdGVuaW5nIG9uICcgKyBwcm9jZXNzLmVudi5QT1JUKTtcbn0pOyJdfQ==
