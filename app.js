"use strict";
var express = require('express');
var http = require('http');
var socketio = require('socket.io');
var UserManager_1 = require('./user/UserManager');
var RoomManager_1 = require('./room/RoomManager');
var ConnectionManager_1 = require('./ConnectionManager');
var app = express();
var server = http.createServer(app);
var io = socketio(server);
var userManager = UserManager_1.default.Instance;
var roomManager = RoomManager_1.default.Instance;
roomManager.io = io;
roomManager.startWatching();
io.on('connection', function (socket) {
    console.log('===> [user ' + socket.id + '] connected');
    var user = userManager.createUser(socket);
    new ConnectionManager_1.default().initSocketEvent(socket, user);
});
app.get('/', function (req, res) {
    res.send('welcome, but you go the wrong way.');
});
server.listen(process.env.PORT || (process.env.PORT = 3100), function () {
    console.log('System:  listening on ' + process.env.PORT);
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBS0EsSUFBTyxPQUFPLFdBQVcsU0FBUyxDQUFDLENBQUM7QUFDcEMsSUFBTyxJQUFJLFdBQVcsTUFBTSxDQUFDLENBQUM7QUFDOUIsSUFBTyxRQUFRLFdBQVcsV0FBVyxDQUFDLENBQUM7QUFHdkMsNEJBQXdCLG9CQUFvQixDQUFDLENBQUE7QUFDN0MsNEJBQXdCLG9CQUFvQixDQUFDLENBQUE7QUFDN0Msa0NBQThCLHFCQUFxQixDQUFDLENBQUE7QUFFcEQsSUFBSSxHQUFHLEdBQUcsT0FBTyxFQUFFLENBQUM7QUFDcEIsSUFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNwQyxJQUFJLEVBQUUsR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUM7QUFFMUIsSUFBSSxXQUFXLEdBQUcscUJBQVcsQ0FBQyxRQUFRLENBQUM7QUFDdkMsSUFBSSxXQUFXLEdBQUcscUJBQVcsQ0FBQyxRQUFRLENBQUM7QUFFdkMsV0FBVyxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUM7QUFHcEIsV0FBVyxDQUFDLGFBQWEsRUFBRSxDQUFDO0FBRzVCLEVBQUUsQ0FBQyxFQUFFLENBQUMsWUFBWSxFQUFFLFVBQVMsTUFBdUI7SUFDakQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxhQUFhLEdBQUcsTUFBTSxDQUFDLEVBQUUsR0FBRyxhQUFhLENBQUMsQ0FBQztJQUd0RCxJQUFJLElBQUksR0FBRyxXQUFXLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBRzFDLElBQUksMkJBQWlCLEVBQUUsQ0FBQyxlQUFlLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDO0FBRTFELENBQUMsQ0FBQyxDQUFDO0FBRUgsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsVUFBUyxHQUFHLEVBQUUsR0FBRztJQUM1QixHQUFHLENBQUMsSUFBSSxDQUFDLG9DQUFvQyxDQUFDLENBQUM7QUFDakQsQ0FBQyxDQUFDLENBQUM7QUFFSCxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLEVBQUU7SUFDM0QsT0FBTyxDQUFDLEdBQUcsQ0FBQyx3QkFBd0IsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQzNELENBQUMsQ0FBQyxDQUFDIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi90eXBpbmdzL25vZGUvbm9kZS5kLnRzXCIvPlxyXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vdHlwaW5ncy9leHByZXNzL2V4cHJlc3MuZC50c1wiLz5cclxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL3R5cGluZ3Mvc29ja2V0LmlvL3NvY2tldC5pby5kLnRzXCIvPlxyXG5cclxuXHJcbmltcG9ydCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xyXG5pbXBvcnQgaHR0cCA9IHJlcXVpcmUoJ2h0dHAnKTtcclxuaW1wb3J0IHNvY2tldGlvID0gcmVxdWlyZSgnc29ja2V0LmlvJyk7XHJcblxyXG5pbXBvcnQgcm9vbSA9IHJlcXVpcmUoJy4vcm9vbS9Sb29tJyk7XHJcbmltcG9ydCBVc2VyTWFuYWdlciBmcm9tICcuL3VzZXIvVXNlck1hbmFnZXInO1xyXG5pbXBvcnQgUm9vbU1hbmFnZXIgZnJvbSAnLi9yb29tL1Jvb21NYW5hZ2VyJztcclxuaW1wb3J0IENvbm5lY3Rpb25NYW5hZ2VyIGZyb20gJy4vQ29ubmVjdGlvbk1hbmFnZXInO1xyXG5cclxubGV0IGFwcCA9IGV4cHJlc3MoKTtcclxubGV0IHNlcnZlciA9IGh0dHAuY3JlYXRlU2VydmVyKGFwcCk7XHJcbmxldCBpbyA9IHNvY2tldGlvKHNlcnZlcik7XHJcblxyXG5sZXQgdXNlck1hbmFnZXIgPSBVc2VyTWFuYWdlci5JbnN0YW5jZTtcclxubGV0IHJvb21NYW5hZ2VyID0gUm9vbU1hbmFnZXIuSW5zdGFuY2U7XHJcblxyXG5yb29tTWFuYWdlci5pbyA9IGlvO1xyXG5cclxuLy8g5byA5aeL55uR5rWL5oi/6Ze06K+35rGC6Zif5YiXXHJcbnJvb21NYW5hZ2VyLnN0YXJ0V2F0Y2hpbmcoKTtcclxuXHJcbi8vIOmFjee9rnNvY2tldC5pb1xyXG5pby5vbignY29ubmVjdGlvbicsIGZ1bmN0aW9uKHNvY2tldDogU29ja2V0SU8uU29ja2V0KSB7XHJcblx0ICBjb25zb2xlLmxvZygnPT09PiBbdXNlciAnICsgc29ja2V0LmlkICsgJ10gY29ubmVjdGVkJyk7XHJcbiAgICBcclxuICAgIC8vIOi/nuaOpeWQjOaXtuWIm+W7uueUqOaIt1xyXG4gICAgbGV0IHVzZXIgPSB1c2VyTWFuYWdlci5jcmVhdGVVc2VyKHNvY2tldCk7IFxyXG4gICAgXHJcbiAgICAvLyDliJ3lp4vljJZzb2NrZXTkuovku7ZcclxuICAgIG5ldyBDb25uZWN0aW9uTWFuYWdlcigpLmluaXRTb2NrZXRFdmVudChzb2NrZXQsIHVzZXIpO1xyXG4gICAgXHJcbn0pO1xyXG5cclxuYXBwLmdldCgnLycsIGZ1bmN0aW9uKHJlcSwgcmVzKXtcclxuICByZXMuc2VuZCgnd2VsY29tZSwgYnV0IHlvdSBnbyB0aGUgd3Jvbmcgd2F5LicpO1xyXG59KTtcclxuXHJcbnNlcnZlci5saXN0ZW4ocHJvY2Vzcy5lbnYuUE9SVCB8fCAocHJvY2Vzcy5lbnYuUE9SVCA9IDMxMDApLCBmdW5jdGlvbigpe1xyXG4gIGNvbnNvbGUubG9nKCdTeXN0ZW06ICBsaXN0ZW5pbmcgb24gJyArIHByb2Nlc3MuZW52LlBPUlQpO1xyXG59KTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
